---
- name: Configure favorite-apps
  dconf:
    key: /org/gnome/shell/favorite-apps
    value: "['org.gnome.Nautilus.desktop']"
    state: present
  tags: ["desktop"]

- name: Configure background
  dconf:
    key: /org/gnome/desktop/background/{{ item.key }}
    value: "{{ item.value }}"
    state: present
  loop:
    - {key: primary-color, value: "'#000000'"}
    - {key: secondary-color, value: "'#000000'"}
    - {key: picture-options, value: "'none'"}
  tags: ["desktop"]

- name: Copy patched dconf module
  copy:
    src: plugins/dconf.py
    dest: "{{ ansible_env['PYENV_VIRTUAL_ENV'] }}/lib/python3.8/\
      site-packages/ansible/modules/system/"
  tags: ["desktop"]

- name: List terminal profile
  dconf:
    key: "/org/gnome/terminal/legacy/profiles:/"
    state: list_sub_dirs
  register: terminal_profiles
  tags: ["desktop"]

- name: Configure GNOME Terminal profile name
  dconf:
    key: "/org/gnome/terminal/legacy/profiles:/\
      {{ terminal_profiles['values'][0] }}visible-name"
    value: "'{{ ansible_env['USER'] }}'"
    state: present
  tags: ["desktop"]

- name: Configure hidden files
  blockinfile:
    path: "{{ ansible_env['HOME'] }}/.hidden"
    block: |
      Desktop
      Documents
      Downloads
      Music
      Pictures
      Public
      Templates
      Videos
    create: true
  tags: ["desktop"]
